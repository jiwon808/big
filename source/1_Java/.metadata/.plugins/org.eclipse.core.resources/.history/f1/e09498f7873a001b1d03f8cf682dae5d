package com.lec.ex09lib;

import java.util.Scanner;

//배열에다. 책. DB //요즘은 다 웹버전
public class LibMain {

	public static void main(String[] args) {
		Book[] books = {new Book("890ㄱ-100","java","아무개"),
						new Book ("890ㄱ-101","hadoop","저무개"),
						new Book ("890ㄱ-102","oracle","이무개"),
						new Book ("890ㄱ-103","python","김무개"),
						new Book ("890ㄱ-104","spark","신무개")
		};
		Scanner sc = new Scanner (System.in);
		int fn, idx=0; // 기능번호(1:대출,2:반납...), 인덱스(books의)
		String bTitle, borrower, checkOutDate; // 책제목, 대출인, 대출일 
		do {
			System.out.println("1:대출 | 2:반납 | 3:도서현황 | 0:종료");
			fn = sc.nextInt();
			switch(fn) {
			case 1: // 책이름 --> 배열(0번부터 끝index까지)에서 책 조회 --> 해당책의 상태 --> 대출인, 대출일 -->대출
				//책이름 입력
				System.out.println("대출할 책이름은?");
				bTitle = sc.next(); //스트링을 받기 위해  next()
				//책조회
				for(idx=0; idx<books.length; idx++) {
					if (bTitle.equals(books[idx].getBookTitle())){  //'Book' 맨 밑에 getter만듬
									//찾았다. 해당idx찾으러가자
						break;
					}
				} 
				//책조회에서 책을 찾았는지 못찾았는지 보고 대출 진행 
				//0이아니면 1로넘어가 만약 부합하면 밑으로 진행
				if(idx!=books.length) { //끝방까지 다돌고. 여기까지 내련온게 == 없다는 듯 
					System.out.println("해당 도서가 없습니다");
					//못찾음
				}else if(books[idx].getState()==ILendable.STATE_BORROWED) { //만약에 상태가 빌린증=대출중 상태면  대출진행 못함
					//찾음 -idx번째것 대출진행
					System.out.println(bTitle +"도서는 대출중입니다");
				}else {
					//대출 가능하니 대출인, 대출일 입력받고 대출진행
					System.out.print("대출인은?");
					borrower = sc.next();
					System.out.print("대출일은?");
					checkOutDate = sc.next();
					books[idx].checkOut(borrower, checkOutDate); 
				}
				break;
			case 2: // 책이름 --> 책조회 --> 반납
				System.out.print("반납할 책이름은?");
				bTitle = sc.next();
				for(idx=0; idx<books.length; idx++) {
					if(bTitle.equals(books[idx].getBookTitle())){
						break;
					}
				}
				break;
			case 3: //for문을 이용해서 도서상태 출력
				for(Book book : books) {
					book.printState();
				}
			}
		}while(fn!=0);  //도서1,2,3계속나와
		System.out.println("시스템 종료");
	}	
}
